#!/bin/sh
#
# wbcachemake
# Created by Hayden Hamilton
#
# haydenvh.com
# Copyright (c) 2020 Hayden Hamilton

${XDG_CACHE_HOME:=$HOME/.cache}
cache="$XDG_CACHE_HOME"

donorm(){
	[ "$args" = "" ] && {
		convert $file -sparse-color Barycentric '0,0 black 0,%h white' -function polynomial 3.2,-3.5,1   /tmp/blurmap.png
		convert $file /tmp/blurmap.png -compose Blur -set option:compose:args 7 -composite $1
	} || {
		convert $file $args $1
	}
	files="$files $1"
}

mkdir -p $cache/wallblur
rm $cache/wallblur/*

for file in $(find images/wallpapers -type f -name "*.png")
do
	echo $file
	donorm "$cache/wallblur/$(basename $file)"
done
