#!/bin/bash
#
# hlockr
# Created by Hayden Hamilton
#
# haydenvh.com
# Copyright (c) 2019 Hayden Hamilton. LICENSE:GPLv2 ../../.licenses/gplv2.license
#

while getopts ":n:i:l:h:b:p:r" o; do case "${o}" in
	i) image=${OPTARG} ;;
	r) resolution=${OPTARG} ;;
	b) blur=${OPTARG} ;;
	p) locker=${OPTARG} ;;
	n) convert="off" ;;
	h) printf "Specify an image with -i, resolution with -r, imagemagick effects with -b, and the program used for locking with -p." ;;
esac done

if [ "$convert" == "off" ]
then
	echo "All image manipulation off..."
	if [ "$image" == "" ]
	then
		echo "No image, please specify one..."
		exit 1
	fi
else
	echo "Generating image..."
	import -window root /tmp/screen.png
	image="/tmp/screen.png"
	resolution=$(xdpyinfo | awk '/dimensions/{print $2}')
	blur="-blur 35 -paint 2"
	locker="i3lock -i"
	convert $image -resize $resolution\! $blur /tmp/screen.png
fi
$locker $image
